---
title: "VIDEO GAMES SALES"
author: "Vismay Chhaganbhai Lad"
date: "12/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

* RStudio 2021.09.1+372 
* R version 4.1.1

_* Documentation of the data sets:_

  + Attribution of the creator of the data: https://www.kaggle.com/gregorut
  + Dataset link : https://www.kaggle.com/gregorut/videogamesales



__INTRODUCTION__

The data set is from Video Game Sales which was generated by a scrape of vgchartz.com. There are over 16500 records.


Because the scraping algorithm focuses on game units sale, the data is not the representation of modern gaming industry. 

The data also favors consoles heavily since most big PC games follows free to play platform!


Nevertheless, this analysis should give us a glimpse at the change in video game industry for the last 3 decades.

_variable Definitions:_

Rank: from the beginning to ending of number.


Name: Name of the game


Platform: Console on which the game is running


Year: No description provided


Genre: No description provided


Publisher: No description provided


NA_Sales: Game sales in North America (in millions of units)


EU_Sales: Game sales in the European Union (in millions of units)


JP_Sales: Game sales in Japan (in millions of units)


Other_Sales: Game sales in the rest of the world, i.e. Africa, Asia excluding Japan, Australia, Europe excluding the E.U. and South America (in millions of units)


Global_Sales: Total sales in the world (in millions of units)


__Libraries and Data set__


```{r warning=FALSE}
library(reshape)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(viridis)
library(lubridate)
library(tm)
library(ngram)
library(RColorBrewer)
library(gridExtra)
library(knitr)
library(cluster)
library(factoextra)
library(plyr)
library(dplyr)
library(corrplot)
library(ggthemes)
library(caret)
library(MASS)
library(randomForest)
library(party)
library(plotly)
library(rpart.plot)
```


```{r}
Finalproject <- read.csv("C:\\Users\\visma\\OneDrive\\Desktop\\DAB501\\Data\\Finalproject.csv",header=TRUE)
```



__Data Inspecting__


We start by taking a glimpse of general characteristics about the data set.


__(1). Finding missing values__


```{r}
colSums(is.na(Finalproject))
```
```{r}
Finalproject1 <- Finalproject %>% drop_na()

```

```{r}
colSums(is.na(Finalproject1))
```


__(2). Head of the data set__

```{r}
head(Finalproject1)
```

__(3). Tail of the data set__

```{r}

tail(Finalproject1)

```
__(4).String__
```{r}
str(Finalproject1)
```


__(5). Summary__
```{r}
summary(Finalproject1)
```


    -So, There is no missing values this data set.
    It is worth our time to take a closer look at these titles in missing values analysis.
    In this summary, we have got min, 1st Qu., Median, Mean, 3rd Qu., Max. 


__Exploratory Data Analysis__


```{r warning=FALSE}
  ggplot(Finalproject1, aes(x = Platform)) +
  geom_bar(fill = "pink") + labs(title = "Platform type", x = "Platform", y = "count")
```


*   We can see that there is lot of platform used by people between 1980 and 2020 but it's highly predicted by the plot.

```{r warning=FALSE}

ggplot(Finalproject1, aes(x = EU_Sales)) +
geom_density(adjust = 0.5) +  labs(title = "EU sales distribution", x = "EU sales", y = "count")

```

*   In the first, Sales was too high but then it slumped and remain zero after some time.


```{r}
 
ggplot(data = Finalproject1, aes(x = JP_Sales, y = Global_Sales )) +
    geom_col(fill = "navyblue") +
    theme(axis.text.x = element_text(angle = 90)) +
    labs(title = "Global Sales Histograms", x = "JP sales", y = "Global Sales ")


```

*   In this plot, there is the description of Goal sales by JP sales respectively. In the first, JP sale and Global sale was good but then it remain stable.

```{r warning=FALSE}
  
#######labs(title = "Games released per Year", x = "Year", y = "Sales (units)")
  
  
```    
  

__Sales of Platform__



```{r}
 ggplot(data =Finalproject1, aes(x = Platform, y = Global_Sales, fill = Year)) +
    geom_bar(stat = "identity") +
    theme_classic() +
    labs(
        x = "Platform",
        y = "Sales",
        title = paste("Visualizing sales of platform by years"
        )
    )
  
  
```

    
*   By the year passing, usage of PS2 increased and PS2 is one of the highest selling platform by 2000.
    

__Time series of global sales__

```{r}
  

    
    ggplot(data= Finalproject1, aes(x = Year, y = Global_Sales)) +
    geom_point(alpha = 0.5, pch = 21) +
  
    scale_color_viridis(discrete = TRUE) +
    theme(legend.position = c(0.2, 0.7)) +
    labs(title = "Time series of Global Sales by Publishers", y = "Sales (in million units)")
```
    
    
*   BY DEPLOTTING, we can see that there is too much congested between points. we can say that over the year passed, the sales of video games have increased, decreased and remain stable.

    
```{r}
 ggplot(data= Finalproject1, aes(x = Other_Sales, y = Global_Sales, fill = Genre)) +
    geom_col(position = "stack") +
    labs(y = "Sales (in million $)", title = "Global Sales by time") +
    scale_fill_viridis(discrete = TRUE)

```


*   In this plot, Sales has almost impacted by years from 1980 to 2020.
    
  
```{r warning=FALSE}

    ggplot(Finalproject1, aes(x = Year, fill = Platform)) +
    geom_density(position = "fill") +
    labs(title = "Distribution of game titles sorted by console type") +
    scale_fill_viridis(discrete = TRUE)

```

*   It's very congested but we can see that PS3 and PS4 is too much used by the year.



```{r}
ggplot(Finalproject1, aes(x = Year , 
fill = Genre )) + 
geom_histogram(binwidth = 5000) + 
facet_wrap(~ Genre, nrow = 3) +
  labs(title = "Distribution of Genre type by Facet gri")
```
    
    
*   This is the Facet grid of year and count divided by Genre. We can see that Action and Adventure is the highest Genre from others.
    
  
```{r}
ggplot(Finalproject1, aes(x = Year , 
fill = Platform)) + 
geom_histogram(binwidth = 5000) +
facet_wrap(~ Platform , nrow = 3) +
  labs(title = "Distribution of Genre platform by Facet gri")

```


*   we can see that DS, PS2 is far use then other whereas ws,TG16, SCD, PCFX, etc. wasn't use for gaming.


__Questions :-__









__Model Fitting__

 * Split the data into training and testing sets.
 Confirm the splitting is correct.

```{r}
set.seed(123)
subset <- sample(nrow(Finalproject1), nrow(Finalproject1) * 0.8)
train = Finalproject1[subset, ]
test = Finalproject1[-subset, ]
```

  _Random forest tree_


```{r}

varNames <- names(Finalproject1)

varNames <- varNames[!varNames %in% c("Year")]
# add + sign between exploratory variables
varNames1 <- paste(varNames, collapse = "+")
# Add the "class" variable and convert it to a formula object
rf_input <- as.formula(paste("Year", varNames1, sep = " ~ "))
```


```{r}
#Building the random forest model
rf_model<-randomForest(rf_input,train,ntree=500,importance=TRUE)
plot(rf_model,main="Error rate")
```


```{r}

varImpPlot(rf_model,sort=T,main="Variable Importance")
```

```{r}
importance(rf_model,sort=T)


```

```{r}
final_rf_model <- randomForest(Year ~ .-Platform - Global_Sales , data = train, importance = TRUE,
                         ntree = 500)

```

```{r}
train$predicted_class <- predict(final_rf_model)
table(train$Platform, train$Genre)

```


__Conclusion__


Game sales peaked in 2008 and has been decreasing ever since. However, the data is not a representation of overall gaming scene.

Modern games focus on free to play platform, dominated by PC games.


The data is flawed since it only takes into account game sales where most revenue from games comes from micro transactions. 

Again, we did not have the data to show PC games on the rise.


EA, Nintendo, Sony are the last few big companies can manage to survive
Most bad games die out instantly in the last few years which signify the rise in standard of games.


The analysis focuses on consoles due to the data structure.
